# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml


trigger:
- master

pool:
  name: Sheetal_Pipeline_Pool
  demands:
   - agent.name -equals my-vm

steps:
- script: echo Hello, world!
  displayName: 'Run a one-line script'

- script: |
  echo Hello World from %AGENT_NAME%.
  echo My ID is %AGENT_ID%.
  echo AGENT_WORKFOLDER contents:
  @dir %AGENT_WORKFOLDER%
  echo AGENT_BUILDDIRECTORY contents:
  @dir %AGENT_BUILDDIRECTORY%
  echo BUILD_SOURCESDIRECTORY contents:
  @dir %BUILD_SOURCESDIRECTORY%
  echo Over and out.
    C:\Users\gsheetald\AppData\Local\Programs\Python\Python310\pip install pytest xlrd pytest-html
    C:\Users\gsheetald\AppData\Local\Programs\Python\Python310\pip install -r requirements.txt
    pytest tests\win --self-contained-html --html="c:/reports/report.html"
    python myscript.py
    move report1.html c:\\reports
    echo "Automation Execution Finished"
  displayName: 'Run a multi-line script'